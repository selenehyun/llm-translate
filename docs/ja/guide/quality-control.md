# 品質管理

::: info 翻訳について
英語以外のドキュメントはすべてClaude Sonnet 4を使用して自動翻訳されています。
:::

llm-translateはSelf-Refineアルゴリズムを使用して、翻訳品質がお客様の要件を満たすことを保証します。

## Self-Refineの仕組み

```
┌─────────────────┐
│ Initial Translate│
└────────┬────────┘
         ▼
┌─────────────────┐
│ Evaluate Quality │◀──────────────┐
└────────┬────────┘               │
         ▼                        │
    Score >= Threshold?           │
         │                        │
    No   │   Yes                  │
         │    │                   │
         ▼    ▼                   │
┌─────────┐ ┌──────┐              │
│ Reflect │ │ Done │              │
└────┬────┘ └──────┘              │
     ▼                            │
┌─────────────────┐               │
│    Improve      │───────────────┘
└─────────────────┘
```

### 1. 初期翻訳

最初の翻訳は以下の要素で生成されます：
- 完全な用語集コンテキスト
- ドキュメント構造情報
- 前のチャンクのコンテキスト（継続性のため）

### 2. 品質評価

各翻訳は4つの基準で評価されます：

| 基準 | 重み | 説明 |
|-----------|--------|-------------|
| 意味的正確性 | 40% | 正しい意味を伝えているか？ |
| 流暢性 | 25% | 対象言語で自然に読めるか？ |
| 用語集準拠 | 20% | すべての用語集の用語が正しく適用されているか？ |
| 形式保持 | 15% | Markdown/HTML構造が維持されているか？ |

### 3. 振り返り

品質がしきい値を下回る場合、LLMは以下を分析します：
- 具体的にどのような問題が存在するか
- どの用語集の用語が見落とされたか
- 流暢性をどこで改善できるか

### 4. 改善

振り返りフィードバックに基づいて対象を絞った修正が適用され、その後サイクルが繰り返されます。

## 設定

### 品質しきい値

```bash
# CLI
llm-translate file doc.md -o doc.ko.md -s en -t ko --quality 90

# Config file
{
  "translation": {
    "qualityThreshold": 90
  }
}
```

### 最大反復回数

```bash
# CLI
llm-translate file doc.md -o doc.ko.md -s en -t ko --max-iterations 6

# Config file
{
  "translation": {
    "maxIterations": 6
  }
}
```

### 厳格モード

品質しきい値が満たされない場合は失敗します：

```bash
llm-translate file doc.md -o doc.ko.md -s en -t ko --strict-quality
```

終了コード：
-`0`- 成功
-`4`- 品質しきい値が満たされない（厳格モード）

## 品質スコアの解釈

| スコア | 品質レベル | 説明 |
|-------|--------------|-------------|
| 95-100 | 優秀 | 公開準備完了 |
| 85-94 | 良好 | 軽微な問題、ほとんどの用途で許容可能 |
| 75-84 | 普通 | 目立つ問題、レビューが必要な場合がある |
| 60-74 | 不良 | 重大な問題、手動レビューが必要 |
| < 60 | 受け入れ不可 | 重大な問題、再翻訳を検討 |

## 出力の理解

```
✓ Translation complete
  Quality: 92/85 (threshold met)
  Breakdown:
    - Accuracy: 38/40
    - Fluency: 24/25
    - Glossary: 18/20
    - Format: 12/15
  Iterations: 2
```

### 詳細分析

- **正確性 (38/40)**: 翻訳は意味的に正しい
- **流暢性 (24/25)**: 対象言語で自然に読める
- **用語集 (18/20)**: ほとんどの用語が適用されているが、一部にバリエーションがある
- **形式 (12/15)**: 軽微な形式調整が必要

## 品質の調整

### より高い品質のために
